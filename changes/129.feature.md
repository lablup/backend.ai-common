Migrate `manager.distribute` and make it to use pluggable distributed lock implementations
